---
source: https://github.com/anthropics/claude-code/issues/24292
fetched: 2026-02-11
type: github-issue
repo: anthropics/claude-code
issue: 24292
state: open
labels: [bug, duplicate, has repro, platform:macos, area:tui, area:core]
---

# teammateMode: "tmux" does not create iTerm2 split panes despite all prerequisites met

**State**: open | **Author**: sankeerthrao | **Created**: 2026-02-09T00:42:12Z
**Labels**: bug, duplicate, has repro, platform:macos, area:tui, area:core
**Reactions**: üëç 1
**Comments**: 3

## Body

## Bug Description

`teammateMode: "tmux"` in `settings.json` does not trigger iTerm2 split panes when spawning agent teammates. All agents fall back to `in-process` mode (confirmed via `backendType: "in-process"` in shutdown messages).

## Environment

- **Claude Code version:** 2.1.32
- **OS:** macOS (Darwin 25.1.0)
- **Terminal:** iTerm2 (`TERM_PROGRAM=iTerm.app`)
- **tmux:** installed (`/opt/homebrew/bin/tmux`, v3.6a)
- **it2 CLI:** installed (`/Users/<user>/.local/bin/it2`, v0.2.3)
- **iTerm2 Python API:** Enabled (Settings ‚Üí General ‚Üí Magic ‚Üí Enable Python API)
- **Not running inside tmux** (`$TMUX` is empty)

## Settings

```json
{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  },
  "model": "claude-opus-4-6[1m]",
  "alwaysThinkingEnabled": true,
  "fastMode": true,
  "teammateMode": "tmux"
}
```

## Steps to Reproduce

1. Open iTerm2 (not inside a tmux session)
2. Ensure `it2` CLI is installed and working (`it2 --version` returns `0.2.3`)
3. Ensure iTerm2 Python API is enabled
4. Set `"teammateMode": "tmux"` in `~/.claude/settings.json`
5. Set `"CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"` in settings env
6. Launch `claude`
7. Ask Claude to create an agent team and spawn teammates (without `run_in_background`)
8. Teammates spawn successfully but all run in **in-process mode** ‚Äî no iTerm2 split panes are created

## Expected Behavior

Per the [documentation](https://docs.claude.com/en/agent-teams#choose-a-display-mode):

> The `"tmux"` setting enables split-pane mode and auto-detects whether to use tmux or iTerm2 based on your terminal.

Since iTerm2 is the active terminal with `it2` CLI installed and Python API enabled, teammates should spawn as iTerm2 split panes.

## Actual Behavior

All teammates spawn in `in-process` mode. The shutdown confirmation messages show `"backendType": "in-process"`, confirming no split panes were created. The `it2` CLI is functional (`it2 session split` works manually) but Claude Code does not invoke it.

## Workaround

Running Claude Code inside a tmux session (`tmux new -s claude && claude`) causes `teammateMode: "auto"` to detect tmux and use native tmux split panes. But the `"tmux"` setting should handle this automatically per the docs, especially for iTerm2.

## Additional Context

- Tested with 5 teammates spawned simultaneously
- `it2 --help` shows `split` command is available and functional
- `it2 session split --vertical` works when run manually from the terminal
- The issue persists across multiple team creation attempts

## Comments

### Comment by github-actions[bot] (2026-02-09T00:44:46Z)

Found 2 possible duplicate issues:

1. https://github.com/anthropics/claude-code/issues/23815
2. https://github.com/anthropics/claude-code/issues/23572

This issue will be automatically closed as a duplicate in 3 days.

- If your issue is a duplicate, please close it and üëç the existing issue instead
- To prevent auto-closure, add a comment or üëé this comment

ü§ñ Generated with [Claude Code](https://claude.ai/code)

### Comment by dyross (2026-02-10T23:16:03Z)

I'm running into something similar, and I think it might have to do with `settings.json` specifically. When I run `claude --teammate-mode tmux`, it does what I expect.

@sankeerthrao can you try that?

**Reactions**: üëç 2

### Comment by anonhostpi (2026-02-11T14:05:24Z)

I believe this impacting all version, not just IT2. tmux isn't working either for me. I believe the issue is that cli.js ends up parsing teammateMode as undefined regardless of which file its defined in:
- https://github.com/anthropics/claude-code/issues/23815#issuecomment-3884632511
